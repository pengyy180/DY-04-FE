<template>
  <view class="page">
	  <!-- ç”¨æˆ·ä¿¡æ¯ -->
    <!-- <view class="my-top">

      <view
        class="head"
        :style="'background-color: rgba(255,255,255,' + scrollTop / 50 + ');'"
      >
        <view class="portrait">
          <view class="setting-mess">
            <view class="setting" @click="onCollect('gohome')">
              <text
                class="iconfont icon-home"
                :style="scrollTop > 20 ? 'color:#333333' : ''"
              ></text>
            </view>
          </view>
        </view>
        <view class="title">
          <text v-show="scrollTop > 20"></text>
        </view>
        <view class="setting-mess">
        
        </view>
      </view>
      <view class="user-info">
        <view class="portrait">
          <image
            :src="userinfo.headPortrait"
          ></image>
        </view>
        <view class="info">
          <view class="nickname">
            <text>{{userinfo.customName}}  </text>
          </view>
          <view class="nickname">
            <text>{{userinfo.customSex=='1'?'ç”·':'å¥³'}}</text> <text>{{userinfo.customPhoneNum}}</text>
          </view>
        </view>
      </view>
      
    </view> -->
	<homenav></homenav>
	
	<view class="procat">
		<view class="protitle">
			æˆ‘çš„è´¦æˆ·
		</view>
	</view>
	<view class="border-radius" >
		<view class="vip-card-area pos-r padding-lr padding-tb-sm" @click="kefu">
			<view class="text-just">
				<view >
					<text class="iconfont iconhuiyuan"></text>
					<text class="margin-left-sm" style="margin-right: 10rpx;">Naturecanå•†åŸ </text>
					<text v-if="userinfo.customLevel == 0"> æ™®é€šä¼šå‘˜</text>
					<text v-if="userinfo.customLevel == 1"> é»„é‡‘ä¼šå‘˜</text>
					<text v-if="userinfo.customLevel == 2"> é“‚é‡‘ä¼šå‘˜</text>
				</view>	
				<text class="margin-left-sm border-r">ç«‹å³ç”³è¯·</text>
			</view>
		</view>
		<view class="order-info">
			
				<view class="list-f">
				  <view class="list" @click="onSkipOrder(0)">
					<view class="icon">
					  <text class="iconfont icon-daifukuan"></text>
					</view>
					<view class="title">
					  <text>å…¨éƒ¨</text>
					</view>
				  </view>
				  <view class="list" @click="onSkipOrder(1)">
					<view class="icon">
					  <text class="iconfont icon-daifahuo"></text>
					</view>
					<view class="title">
					  <text>å¾…å‘è´§</text>
					</view>
				  </view>
				  <view class="list" @click="onSkipOrder(2)">
					<view class="icon">
					  <text class="iconfont icon-daishouhuo"></text>
					</view>
					<view class="title">
					  <text>å·²å®Œæˆ</text>
					</view>
				  </view>
		  </view>
		</view>
		<!-- <view class="moneylist">
			<view class="li" >
				<view class="number">{{userinfo.givenAccount.num}}{{userinfo.givenAccount.unit}}</view>
				<view class="title">æˆ‘çš„ä½™é¢</view>
			</view>
			<view class="li">
				<view class="number">0</view>
				<view class="title">æˆ‘çš„ç§¯åˆ†</view>
			</view>
			<view class="li">
				<view class="number">0</view>
				<view class="title">ä¼˜æƒ åˆ¸</view>
			</view>
		</view> -->
		
	</view>
	
    <view class="border-radius" >
    	<view class="vip-card-area pos-r padding-lr padding-tb-sm" @click="kefu">
    		<view class="text-just">
    			<view >
    				<text class="iconfont icon-qianbao"></text>
    				<text class="margin-left-sm" style="margin-right: 10rpx;">æˆ‘çš„é’±åŒ… </text>
    			</view>	
    		</view>
    	</view>
    	
    	<view class="moneylist">
    		<view class="li" >
    			<view class="number">{{userinfo.givenAccount.num}}{{userinfo.givenAccount.unit}}</view>
    			<view class="title">æˆ‘çš„ä½™é¢</view>
    		</view>
    		<view class="li">
    			<view class="number">0</view>
    			<view class="title">æˆ‘çš„ç§¯åˆ†</view>
    		</view>
    		<view class="li">
    			<view class="number">0</view>
    			<view class="title">ä¼˜æƒ åˆ¸</view>
    		</view>
    	</view>
    	
    </view>
    <view class="border-radius border-radius2" >
    	<view class="vip-card-area pos-r padding-lr padding-tb-sm" @click="kefu">
    		<view class="text-just">
    			<view >
    				<text class="cuIcon-list"></text>
    				<text class="margin-left-sm" style="margin-right: 10rpx;">æ›´å¤šåŠŸèƒ½ </text>
    			</view>	
    		</view>
    	</view>
		<view class="borderff">
			<view class="title-v" @click="onSetting">
				<view class="left">
					<image class="iconimg" src="../../static/my1.png" mode=""></image>ä¸ªäººèµ„æ–™
				</view>
				<view class="right">
					å¡«å†™ä¿¡æ¯ <text class="iconfont iconjiantou-01"></text>
				</view>
			</view>	
			<view class="title-v" @click="onWallet('SignIn')">
				<view class="left">
					<image class="iconimg" src="../../static/my2.png" mode=""></image>é“¶è¡Œå¡ç»‘å®š
				</view>
				<view class="right">
					é“¶è¡Œå¡è®¾ç½® <text class="iconfont iconjiantou-01"></text>
				</view>
			</view>	
			<view class="title-v" @click="onWallet('wallet')">
				<view class="left">
					<image class="iconimg" src="../../static/my3.png" mode=""></image>æˆ‘çš„é’±åŒ…
				</view>
				<view class="right">
					é’±åŒ…ç®¡ç† <text class="iconfont iconjiantou-01"></text>
				</view>
			</view>	
			<view class="title-v" @click="onWallet('address')">
				<view class="left">
					<image class="iconimg" src="../../static/my4.png" mode=""></image>æ”¶è´§åœ°å€
				</view>
				<view class="right">
					æ”¶è´§åœ°å€ <text class="iconfont iconjiantou-01"></text>
				</view>
			</view>	
			<view class="title-v" @click="onWallet('ChangePassword')">
				<view class="left">
					<image class="iconimg" src="../../static/my5.png" mode=""></image>å¯†ç è®¾ç½®
				</view>
				<view class="right">
					å¯†ç è®¾ç½® <text class="iconfont iconjiantou-01"></text>
				</view>
			</view>	
			<view class="title-v" @click="kefu()">
				<view class="left">
					<image class="iconimg" src="../../static/my6.png" mode=""></image>å®˜æ–¹å®¢æœ
				</view>
				<view class="right">
					åœ¨çº¿å®¢æœ <text class="iconfont iconjiantou-01"></text>
				</view>
			</view>	
			<view class="title-v" @click="onServer('feedback')">
				<view class="left">
					<image class="iconimg" src="../../static/my7.png" mode=""></image>å…³äºNaturecan
				</view>
				<view class="right">
					äº†è§£æ›´å¤š <text class="iconfont iconjiantou-01"></text>
				</view>
			</view>	
		</view>
    </view>
    <!-- é’±åŒ… -->
	
	
    <!-- <view class="wallet-info">
      <view class="list" @click="onWallet('chongzhi')">
        <view class="icon">
          <text class="iconfont icon-tuikuan"></text>
        </view>
        <view class="title">
          <text>å……å€¼</text>
        </view>
      </view>
      <view class="list" @click="onWallet('tixian')">
        <view class="icon">
          <text class="iconfont icon-qianbao"></text>
        </view>
        <view class="title">
          <text>æç°</text>
        </view>
      </view>
      <view class="list" @click="onWallet('wallet')">

        <view class="icon">
          <text class="number">{{userinfo.givenAccount}}</text>
        </view>
        <view class="title">
          <text>ä½™é¢</text>
        </view>
      </view>
    </view>
    <view class="integral-payment">
      <view class="list" @click="onSetting">
        <view class="title">
          <text
            class="cuIcon-card"
            style="font-weight: bold; width: 50rpx; font-size: 20px"
          ></text>
          <text>ä¸ªäººèµ„æ–™</text>
        </view>
        <view class="mess">
          <text>å¡«å†™ä¿¡æ¯ æ›´å®‰å…¨</text>
        </view>
      </view>
      <view class="list" @click="onWallet('SignIn')">
        <view class="title">
          <text
            class="cuIcon-card"
            style="font-weight: bold; width: 50rpx; font-size: 20px"
          ></text>
          <text>é“¶è¡Œå¡</text>
        </view>
        <view class="mess">
          <text>ç»‘å®šé“¶è¡Œå¡ æ›´ä¾¿æ·</text>
        </view>
      </view>
    </view> -->
    <!-- æˆ‘çš„æœåŠ¡ -->
    <!-- <view class="my-service">
      <view class="title">
        <text>æˆ‘çš„æœåŠ¡</text>
      </view>
      <view class="service-list">

		<view class="list">
          <view class="thumb">
            <text class="cuIcon-edit" style="font-size: 20px"></text>
          </view>
          <view class="name">
            <text>å…³äºNaturecan</text>
          </view>
        </view>
        <view class="list" @click="kefu2()">
          <view class="thumb">

            <text class="cuIcon-people" style="font-size: 20px"></text>
          </view>
          <view class="name">
            <text>å®¢æœçƒ­çº¿</text>
          </view>
        </view>
        <view class="list" >
          <view class="thumb">
            <text class="cuIcon-exit" style="font-size: 20px"></text>
			</view>
          <view class="name" @click="loginout">
            <text>é€€å‡ºç™»å½•</text>
          </view>
        </view>
      </view>
    </view> -->
	<!-- æˆ‘çš„æœåŠ¡ -->
	
	<view class="aboutme">
		<view class="li">
			<image class="aboutimg1" src="/static/a1.webp" mode=""></image>
		</view>
		<view class="li">
			<image class="aboutimg1" src="/static/a2.webp" mode=""></image>
		</view>
		<view class="li">
			<image class="aboutimg2" src="/static/a3.webp" mode=""></image>
			<image class="aboutimg2" src="/static/a4.webp" mode=""></image>
		</view>
		<view class="li">
			<image class="aboutimg3" src="/static/a5.webp" mode=""></image>
			<image class="aboutimg4" src="/static/a6.webp" mode=""></image>
		</view>
	</view>
	<view class="copyright">
		Â© 2022, Naturecan Ltd - Bank Chambers, Stockport, SK1 1AR, UK
	</view>
	<view class="china">
		ğŸ‡¨ğŸ‡³ CHINA
	</view>
	<view class="smallabout">
		This product is not for use by or sale to persons under the age of 18. This product should be used only as directed on the label. It should not be used if you are pregnant or nursing. Consult with a physician before use if you have a serious medical condition or use prescription medications. A Doctor's advice should be sought before using this and any supplemental dietary product. All trademarks and copyrights are property of their respective owners and are not affiliated with nor do they endorse this product. These statements have not been evaluated by the FDA. This product is not intended to diagnose, treat, cure or prevent any disease. Individual weight loss results will vary. By using this site, you agree to follow the Privacy Policy and all Terms & Conditions printed on this site. Void Where Prohibited by Law.
	</view>
	<!-- <view class="my-service">
	  <view class="title">
	    <text>å…³äºå¹³å°</text>
	  </view>
	  <view class="service-list" style="color: #959595;text-align: center;padding-bottom: 20rpx;">
	    Naturecanå•†åŸäº1996å¹´ç¾å›½æˆç«‹ï¼Œ2010å¹´æ¥åˆ°ä¸­å›½ï¼Œå‘å…¨ä¸–ç•Œ150å¤šä¸ªå›½å®¶æä¾›å•†å“ã€‚å¤šå¹´æ¥ï¼ŒNaturecanè·å¾—äº†ä»¤äººæ›™ç›®çš„æˆç»©ã€‚

	  </view>
	</view> -->
    <!-- ä¸ºä½ æ¨è -->
    <!-- <view class="recommend-info">
      <view class="recommend-title">
        <view class="title">
          <image src="/static/wntj_title.png" mode=""></image>
        </view>
      </view>
      <view class="goods-list">
        <view
          class="list"
          v-for="(item, index) in goodsList"
          @click="onSkip('goods')"
          :key="index"
        >
          <view class="pictrue">
            <image :src="item.img" mode="heightFix"></image>
          </view>
          <view class="title-tag">
            <view class="tag">
              <text v-if="item.is_goods === 1">ç‰¹ä»·</text>
              {{ item.name }}
            </view>
          </view>
          <view class="price-info">
            <view class="user-price">
              <text class="min">ï¿¥</text>
              <text class="max">{{ item.price }}</text>
            </view>
            <view class="vip-price">
              <image src="/static/vip_ico.png"></image>
              <text>ï¿¥{{ item.vip_price }}</text>
            </view>
          </view>
        </view>
      </view>
    </view> -->
    <!-- å®¢æœçƒ­çº¿ -->
	<view style="text-align: center;">
		<view style="">
			<img style="width: 80px;margin: 0 30rpx;" src="../../static/styleimg/footer-badge-satisfaction.png" alt="">
			<img style="width: 80px;margin: 0 30rpx;" src="../../static/styleimg/footer-badge-years.png" alt="">
		</view>
		<view style="clear: both;"></view>
	</view>
	<view style="text-align: center;font-size: 10rpx;padding: 20px 0 50px;">Â© 2005 - 2022 TopCashback - ç‰ˆæƒæ‰€æœ‰</view>
	<view style="text-align: center;">
		<view style="">
			<img style="width: 120px;" src="../../static/styleimg/footer-ssl-cn.png" alt="">
		</view>
		<view style="clear: both;"></view>
	</view>
	
	
    <!-- tabbar -->
	<DialogBox ref="DialogBox"></DialogBox>
    <!-- <TabBar :tabBarShow="3"></TabBar> -->
  </view>
</template>

<script>
import { updateCustomData,findCustomData,findKefu } from "../../api/index";

import TabBar from "../../components/TabBar/TabBar.vue";
	import __config from "../../config/env.js";
	import homenav from "../../components/homenav.vue";//åˆ¤æ–­ç”¨æˆ·ä¿¡æ¯
export default {
  components: {
    TabBar,
	homenav

  },
  data() {
    return {
		action:__config.imgaction,
      scrollTop: 0,
      isHotline: false,
      goodsList: [],
	  userinfo:[]
    };
  },
  onReady() {
    uni.hideTabBar();
  },
  onPageScroll(e) {
    this.scrollTop = e.scrollTop;
  },
  onLoad() {
  	this.checkuserinfo()
  },
  onShow() {
  	this.checkuserinfo()
  },
  methods: {
	  handleMoney(num,ok) {
	    // é¦–å…ˆå…ˆå£°æ˜ä¸€ä¸ªé‡‘é¢å•ä½æ•°ç»„
		let AmountUnitlist = ["å…ƒ", "ä¸‡å…ƒ", "äº¿", "å…†", 'äº¬', 'å“', 'æ¼']
		if(ok == 1){
			AmountUnitlist = ["å…ƒ", "ä¸‡å…ƒ", "äº¿", "å…†", 'äº¬', 'å“', 'æ¼']
		}else if(ok == 2){
			AmountUnitlist = ["åˆ†", "ä¸‡åˆ†", "äº¿", "å…†", 'äº¬', 'å“', 'æ¼']
		}
	    // å°†æ•°å­—é‡‘é¢è½¬ä¸ºå­—ç¬¦ä¸²
	    let strnum = num.toString()
	    // å£°æ˜ä¸€ä¸ªå˜é‡ç”¨äºæ¥æ”¶é‡‘é¢å•ä½
	    let AmountUnit = ''
	    // å¾ªç¯éå†å•ä½æ•°ç»„
	    AmountUnitlist.find((item, index) => {
	      let newNum = ''
	      // åˆ¤æ–­ä¸€ä¸‹ä¼ è¿›æ¥çš„é‡‘é¢æ˜¯å¦åŒ…å«å°æ•°ç‚¹
	      if (strnum.indexOf('.') !== -1) {
	        // è‹¥æœ‰åˆ™å°†å°æ•°ç‚¹å‰çš„å­—ç¬¦æˆªå–å‡ºæ¥
	        newNum = strnum.substring(0, strnum.indexOf('.'))
	      } else {
	        // æ²¡æœ‰åˆ™ç›´æ¥ç­‰äºåŸé‡‘é¢
	        newNum = strnum
	      }
	      // åˆ¤æ–­ä¸€ä¸‹ç»è¿‡å°æ•°ç‚¹æˆªå–åçš„é‡‘é¢å­—ç¬¦é•¿åº¦æ˜¯å¦å°äº5
	      if (newNum.length < 5) {
	        // è‹¥å°äº5åˆ™æ¥æ”¶å½“å‰å•ä½ï¼Œå¹¶è·³å‡ºè¿­ä»£
	        AmountUnit = item
	        return true
	      } else {
	        // è‹¥ä¸å°äº5åˆ™å°†ç»è¿‡å°æ•°ç‚¹æˆªå–å¤„ç†è¿‡åçš„å­—ç¬¦é™¤ä»¥10000åä½œä¸ºä¸‹ä¸€è½®è¿­ä»£çš„åˆå§‹é‡‘é¢é‡æ–°åˆ¤æ–­(æ¯ä¸€ä¸ªå•ä½ä¹‹é—´ç›¸è·4ä½æ•°ï¼Œæ•…é™¤ä»¥10000)
	        strnum = (newNum * 1 / 10000).toString()
	      }
	    })
	    let money = {num: 0, unit: ""}
	    // ä¿ç•™2ä½å°æ•°
	    money.num = (strnum * 1).toFixed(2)
	    // æ¥æ”¶å•ä½
	    money.unit = AmountUnit
	    return money
	  },
	  loginout(){
		  this.$refs['DialogBox'].confirm({
		  	title: 'æç¤º',
		  	content: 'æ˜¯å¦è¦é€€å‡ºç™»å½•?',
		  	DialogType: 'inquiry',
		  	animation: 0
		  }).then(()=>{
		  	uni.clearStorage();
		  	uni.reLaunch({
		  		url:'/pages/login/login'
		  	})
		  	
		  
		  })
	  },
	  checkuserinfo(){
	  	let _this = this
	  	
	  	findCustomData().then(res=>{
	  		_this.userinfo = res.result
			
			_this.userinfo.headPortrait = _this.action+'/'+res.result.headPortrait
			_this.userinfo.givenAccount = _this.handleMoney(_this.userinfo.givenAccount,1)
			_this.userinfo.realAccount = _this.handleMoney(_this.userinfo.realAccount/10,2)
	  	})
	  
	  },
    //å®¢æœ
    kefu() {
		findKefu().then((res)=>{
			console.log(res.result)
			window.location.href="https://chatlink.mstatik.com/widget/standalone.html?eid="+res.result
		})
	},
	kefu2() {
		
		uni.makePhoneCall({
			phoneNumber: '(+1) 9792707575' //ä»…ä¸ºç¤ºä¾‹
		});
	},
    /**
     * å…³æ³¨è·³è½¬
     */
    onCollect(type) {
      switch (type) {
        case "gohome":
          uni.navigateTo({
            url: "/pages/home/home",
          });
          break;
        case "content":
          uni.navigateTo({
            url: "/pages/ContentCollection/ContentCollection",
          });
          break;
        case "record":
          uni.navigateTo({
            url: "/pages/BrowsingHistory/BrowsingHistory",
          });
          break;
      }
    },
    /**
     * è®¢å•
     */
    onSkipOrder(type) {
      if (type === 5) {
        uni.navigateTo({
          url: "/pages/AfterSalesOrder/AfterSalesOrder",
        });
        return;
      }
      uni.navigateTo({
        url: "/pages/MyOrderList/MyOrderList?type=" + type,
      });
    },
    /**
     * é’±åŒ…è·³è½¬ç‚¹å‡»
     */
    onWallet(type) {
      switch (type) {
		  
		  case "ChangePassword":
		    uni.navigateTo({
		      url: "/pages/ChangePassword/ChangePassword",
		    });
		    break;
		case "address":
		  uni.navigateTo({
		    url: "/pages/AddressEdit/AddressEdit",
		  });
		  break;
        case "integral":
          uni.navigateTo({
            url: "/pages/IntegralDetails/IntegralDetails",
          });
          break;
        case "coupon":
          uni.navigateTo({
            url: "/pages/MyCoupon/MyCoupon",
          });
          break;
        case "wallet":
          uni.navigateTo({
            // url: "/pages/ConsumeRecord/ConsumeRecord?type=0",
			url: "/pages/MyWallet/MyWallet",
          });
          break;
        case "SignIn":
          uni.navigateTo({
            url: "/pages/SignIn/SignIn",
          });
          break;
        case "payment":
          uni.navigateTo({
            url: "/pages/PaymentCode/PaymentCode",
          });
          break;
		  case "chongzhi":
		      uni.navigateTo({
		        url: "/pages/MyWallet/MyWallet",
		      });
		      break;
		  case "tixian":
		  	  uni.navigateTo({
		  	    url: "/pages/cart/cart",
		  	  });
		  	  break;
      }
    },
    /**
     * æˆ‘çš„æœåŠ¡ç‚¹å‡»
     */
    onServer(type) {
      switch (type) {
        case "feedback":
          uni.navigateTo({
            url: "/pages/Feedback/Feedback",
          });
          break;
        case "serve":
          this.isHotline = true;
          break;
      }
    },
    /**
     * è®¾ç½®ç‚¹å‡»
     */
    onSetting() {
      uni.navigateTo({
        url: "/pages/Setting/Setting",
      });
    },
    /**
     * æ¶ˆæ¯ç‚¹å‡»
     */
    onMessage() {
      uni.navigateTo({
        url: "/pages/Message/Message",
      });
    },
    /**
     * ä¼šå‘˜ç‚¹å‡»
     */
    onMmeberVip() {
      uni.navigateTo({
        url: "/pages/MembersOpened/MembersOpened",
      });
    },
    /**
     * è·³è½¬ç‚¹å‡»
     * @param {String} type è·³è½¬ç±»å‹
     */
    onSkip(type) {
      switch (type) {
        case "goods":
          uni.navigateTo({
            url: "/pages/GoodsDetails/GoodsDetails",
            animationType: "zoom-fade-out",
            animationDuration: 200,
          });
          break;
      }
    },
    /**
     * ç”¨æˆ·ä¿¡æ¯ç‚¹å‡»
     * @param {Number} type
     */
    onUserInfo() {
      uni.navigateTo({
        url: "/pages/login/login",
      });
    },
  },
};
</script>

<style scoped lang="scss">
@import "my.scss";
@import "@/pages/home/home.scss";
</style>
